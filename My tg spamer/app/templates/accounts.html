{% extends 'base.html' %}
{% block content %}
<div class='card'>
  <h2>Add Account</h2>
  <form method='post' action='/accounts/add' class='row'>
    <div>
      <label>Phone (+380...)</label>
      <input name='phone' required>
    </div>
    <div>
      <label>Name (optional)</label>
      <input name='name'>
    </div>
    <div>
      <label>API ID (optional)</label>
      <input name='api_id' type='number'>
    </div>
    <div>
      <label>API Hash (optional)</label>
      <input name='api_hash'>
    </div>
    <div>
      <button type='submit'>Add</button>
    </div>
  </form>
  <form method='post' action='/accounts/add_and_login' class='row' style='margin-top:12px'>
    <div>
      <label>Phone (+380...)</label>
      <input name='phone' required>
    </div>
    <div>
      <label>Name (optional)</label>
      <input name='name'>
    </div>
    <div>
      <label>API ID (optional)</label>
      <input name='api_id' type='number'>
    </div>
    <div>
      <label>API Hash (optional)</label>
      <input name='api_hash'>
    </div>
    <div>
      <button type='submit'>Add & Login</button>
    </div>
  </form>
</div>
<div class='card'>
  <h2>Accounts</h2>
  <table>
    <tr>
      <th style="width:60px;">ID</th>
      <th style="width:180px;">Phone</th>
      <th style="width:180px;">Name</th>
      <th style="width:100px;">Authorized</th>
      <th style="width:200px;">Actions</th>
    </tr>
    {% for a in accounts %}
    <tr>
      <td>{{a.id}}</td>
      <td>{{a.phone}}</td>
      <td>{{a.name or ''}}</td>
      <td style="text-align:center;">{{'✅' if a.is_authorized else '❌'}}</td>
      <td>
        <div style="display:flex;gap:6px;">
        {% if not a.is_authorized %}
        <form method='post' action='/accounts/{{a.id}}/login/start' style="display:inline;">
          <button>Start Login</button>
        </form>
        {% else %}—{% endif %}
        <form method='post' action='/accounts/{{a.id}}/delete' onsubmit="return confirm('Delete this account? This will remove its session file and logs.');" style="display:inline;">
          <button class='secondary'>Delete</button>
        </form>
        </div>
      </td>
    </tr>
    {% endfor %}
  </table>
</div>
{% endblock %}